<abp-modal [(visible)]="visible" [options]="modalOptions" (visibleChange)="visibleChange.emit($event)">
    <ng-template #abpHeader>
        <div class="d-flex align-items-center justify-content-between w-100">
            <div class="d-flex flex-column">
                <div class="modal-title-line">
                    <span class="h2">{{ vinNo ?? '-' }}</span>
                    <span class="ms-2">{{ '::ExternalApiResponse' | abpLocalization }}</span>
                </div>
            </div>
        </div>
    </ng-template>

    <ng-template #abpBody>
        @if(loading) {
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">...</span>
            </div>
            <p class="mt-2 text-muted">{{ '::Loading' | abpLocalization }}...</p>
        </div>
        }

        @if(!loading && !specs){
        <div class="alert alert-warning" role="alert">
            {{ '::NoExternalDataFound' | abpLocalization }}
        </div>
        }

        @if(!loading && specs && !specs.success){
        <div class="alert alert-danger" role="alert">
            {{ '::ExternalApiResponseFailed' | abpLocalization }}
        </div>
        <div class="p-2">
            <p class="text-danger mb-0">{{ specs.error || 'Unknown error' }}</p>
        </div>
        }

        @if(!loading && specs?.success){
        <table class="table table-bordered">
            <tbody>
                @for (row of displayItems; track $index) {

                @if (row[0].isHeader) {
                <tr class="bg-secondary header">
                    <td colspan="4">
                        <h6 class="m-0 fw-bold text-white text-uppercase small ls-1">
                            {{ row[0].value }}
                        </h6>
                    </td>
                </tr>
                }

                @else if (row[0].isValueOnly || row[0].isFullWidth) {
                <tr>
                    <td colspan="4">
                        {{ row[0].value }}
                    </td>
                </tr>
                }

                @else {
                <tr>
                    <td class="spec-label text-muted" style="width: 25%;">{{ row[0].key }}</td>
                    <td style="width: 25%;">{{ row[0].value }}</td>

                    @if (row[1]) {
                    <td class="spec-label text-muted" style="width: 25%;">{{ row[1].key }}</td>
                    <td style="width: 25%;">{{ row[1].value }}</td>
                    }
                    @else {
                    <td colspan="2"></td>
                    }
                </tr>
                }
                }
            </tbody>
        </table>
        }
    </ng-template>

    <ng-template #abpFooter>
        <button type="button" class="btn btn-outline-secondary px-3" (click)="close()">
            {{ '::Close' | abpLocalization }}
        </button>
    </ng-template>
</abp-modal>