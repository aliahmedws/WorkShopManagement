<div class="card">
    <div class="card-header">
        <div class="card-title align-items-center d-flex justify-content-center">
            {{ '::AMQ-RAMRemanufactureLine' | abpLocalization }}
        </div>
    </div>

    <div class="card-body">
        <div class="row g-3">
            <div class="col-12 col-md-6 col-xl-3" *ngFor="let bay of bayOptions; trackBy: trackByBayId">

                <!-- Bay title -->
                <div class="bay-title text-center mb-2">
                    {{ bay.displayName }}
                </div>

                <!-- get assignment -->
                @let a = getAssignment(bay.id);

                <div class="bay-box" [class.bay-box--assigned]="!!a" role="button" tabindex="0"
                    (click)="onOpenBay(bay)">

                    <!-- Unassigned -->
                    <ng-container *ngIf="!a; else assignedTpl">
                        <div class="bay-box__center text-muted fw-semibold">
                            {{ '::Unassigned' | abpLocalization }}
                        </div>
                    </ng-container>

                    <!-- Assigned -->
                    <ng-template #assignedTpl>
                        <div class="bay-card p-2">

                            <!-- top row -->
                            <div class="d-flex align-items-start justify-content-between">
                                <div class="fw-bold">
                                    {{ vinLast6(a?.carVin) }}
                                </div>

                                <div class="d-flex align-items-center gap-2">
                                    <span class="badge text-bg-warning">
                                        {{ priorityText(a?.priority) }}
                                    </span>

                                    <button type="button" class="btn btn-sm btn-link text-danger p-0 bay-clear"
                                        *ngIf="a?.id" (click)="onDelete(a.id, $event)" aria-label="Clear bay"
                                        title="Clear bay">
                                        âœ•
                                    </button>

                                </div>
                            </div>

                            <div class="d-flex justify-content-center my-2">
                                <img *ngIf="a?.modelImagePath; else noImg" nz-image width="160" height="95"
                                    [nzSrc]="a.modelImagePath" [alt]="a?.modelName || 'model'"
                                    style="object-fit: cover; border-radius: 2px; pointer-events: none;"/>

                                <ng-template #noImg>
                                    <div class="text-muted small">-</div>
                                </ng-template>
                            </div>


                            <!-- center text -->
                            <div class="text-center">
                                <div class="small fw-bold">
                                    {{ a?.ownerName ?? '-' }}
                                </div>

                                <div class="small fw-bold">
                                    {{ a?.modelName ?? '-' }}
                                </div>

                                <div class="small fw-bold">
                                    {{ '::ManufactureStartDate' | abpLocalization }}:
                                    <span *ngIf="a?.manufactureStartDate; else dashDate">
                                        {{ a?.manufactureStartDate | date:'dd/MMM/yyyy' }}
                                    </span>
                                    <ng-template #dashDate>-</ng-template>
                                </div>

                                <div class="small fw-bold">
                                    {{ a?.modelCategoryName ?? '-' }}
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- your grid / bay cards html stays the same -->

<app-production-details-modal #detailsModal></app-production-details-modal>
